<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System Puzzle</title>
    <link rel="icon" href="WhBr-Rabbit-logo-golden-220609-v1.png" type="image/x-icon">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Alice&display=swap');
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Alice', serif;
            text-align: center;
            margin: 0;
            background: #000;
            color: #ffa500;
        }
        .container {
            width: 100%;
            max-width: 400px;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .logo {
            width: 110px;
            height: auto;
            margin-bottom: 10px;
        }
        h1 {
            margin: 10px 0;
        }
        #game-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 20px auto;
            border: 2px solid #ffa500;
            border-radius: 50%;
            background: rgba(255, 165, 0, 0.1);
        }
        .sun {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #ffa500;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px #ffa500;
        }
        .orbit {
            position: absolute;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
        }
        .orbit[data-orbit="mercury"] { width: 60%; height: 60%; border: 1px solid rgba(255, 165, 0, 0.5); }
        .orbit[data-orbit="venus"] { width: 70%; height: 70%; border: 1px solid rgba(255, 165, 0, 0.6); }
        .orbit[data-orbit="earth"] { width: 80%; height: 80%; border: 1px solid rgba(255, 165, 0, 0.7); }
        .orbit[data-orbit="mars"] { width: 85%; height: 85%; border: 1px solid rgba(255, 165, 0, 0.8); }
        .orbit[data-orbit="jupiter"] { width: 90%; height: 90%; border: 1px solid rgba(255, 165, 0, 0.9); }
        .orbit[data-orbit="saturn"] { width: 95%; height: 95%; border: 1px solid rgba(255, 165, 0, 1); }
        .planet {
            position: absolute;
            background: #ffa500;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform-origin: center;
        }
        .planet[data-planet="mercury"] { width: 6px; height: 6px; }
        .planet[data-planet="venus"] { width: 8px; height: 8px; }
        .planet[data-planet="earth"] { width: 8px; height: 8px; }
        .planet[data-planet="mars"] { width: 7px; height: 7px; }
        .planet[data-planet="jupiter"] { width: 12px; height: 12px; }
        .planet[data-planet="saturn"] { width: 11px; height: 11px; }
        #move-counter {
            margin-top: 10px;
        }
        #reset-button {
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        #reset-button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="https://www.whitebranches.com/keyhole" target="_blank">
            <img src="WhBr-Rabbit-logo-golden-220609-v1.png" class="logo" alt="Logo">
        </a>
        <h1>Solar System Puzzle</h1>
        <p>Align all planets vertically!</p>
        <div id="game-container">
            <div class="sun"></div>
            <div class="orbit" data-orbit="mercury"><div class="planet" data-planet="mercury"></div></div>
            <div class="orbit" data-orbit="venus"><div class="planet" data-planet="venus"></div></div>
            <div class="orbit" data-orbit="earth"><div class="planet" data-planet="earth"></div></div>
            <div class="orbit" data-orbit="mars"><div class="planet" data-planet="mars"></div></div>
            <div class="orbit" data-orbit="jupiter"><div class="planet" data-planet="jupiter"></div></div>
            <div class="orbit" data-orbit="saturn"><div class="planet" data-planet="saturn"></div></div>
        </div>
        <div id="move-counter">Moves: 0</div>
        <button id="reset-button">Reset</button>
        <audio id="success-sound" src="success.mp3" preload="auto"></audio>
    </div>
    <script>
        const orbits = document.querySelectorAll('.orbit');
        let moveCount = 0;
        let planetsAligned = false;

        function rotatePlanet(planet, angle) {
            const currentRotation = getRotationAngle(planet);
            planet.style.transform = `rotate(${currentRotation + angle}deg) translate(${planet.parentElement.offsetWidth / 2}px) rotate(${-currentRotation - angle}deg)`;
        }

        function getRotationAngle(element) {
            const transform = element.style.transform;
            const matches = transform.match(/rotate\(([-\d.]+)deg\)/);
            return matches ? parseFloat(matches[1]) : 0;
        }

        function checkAlignment() {
            const tolerance = 5; // degrees
            const planets = document.querySelectorAll('.planet');
            const aligned = Array.from(planets).every(planet => {
                const angle = getRotationAngle(planet) % 360;
                return (angle >= 360 - tolerance || angle <= tolerance);
            });

            if (aligned && !planetsAligned) {
                planetsAligned = true;
                document.getElementById('success-sound').play();
                setTimeout(() => {
                    document.body.style.transition = 'opacity 1s';
                    document.body.style.opacity = 0;
                    setTimeout(() => {
                        window.location.href = 'next.html';
                    }, 1000);
                }, 500);
            }
        }

        function rotateOrbit(orbitIndex, clockwise) {
            const rotationAmounts = [30, -40, 50, -60, 70, -80]; // Degrees to rotate for each orbit
            const affectedOrbits = [
                [0, 1, 2],    // Mercury affects itself, Venus, and Earth
                [0, 1, 2, 3], // Venus affects Mercury, itself, Earth, and Mars
                [1, 2, 3, 4], // Earth affects Venus, itself, Mars, and Jupiter
                [2, 3, 4, 5], // Mars affects Earth, itself, Jupiter, and Saturn
                [3, 4, 5],    // Jupiter affects Mars, itself, and Saturn
                [4, 5]        // Saturn affects Jupiter and itself
            ];

            affectedOrbits[orbitIndex].forEach(index => {
                const planet = orbits[index].querySelector('.planet');
                const rotationAmount = rotationAmounts[index] * (clockwise ? 1 : -1);
                rotatePlanet(planet, rotationAmount);
            });

            moveCount++;
            document.getElementById('move-counter').textContent = `Moves: ${moveCount}`;
            checkAlignment();
        }

        orbits.forEach((orbit, index) => {
            orbit.addEventListener('click', () => rotateOrbit(index, true));
            orbit.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                rotateOrbit(index, false);
            });
        });

        function resetGame() {
            planetsAligned = false;
            moveCount = 0;
            document.getElementById('move-counter').textContent = 'Moves: 0';
            orbits.forEach(orbit => {
                const planet = orbit.querySelector('.planet');
                const randomAngle = Math.floor(Math.random() * 360);
                rotatePlanet(planet, randomAngle);
            });
        }

        document.getElementById('reset-button').addEventListener('click', resetGame);

        resetGame();
    </script>
</body>
</html>
